

<!DOCTYPE html>
<html class="writer-html5" lang="vi" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5. Mẹo với SQL &mdash; Tài liệu Khai thác dữ liệu với SQL 2019</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=33847982"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
      <script src="_static/translations.js?v=4c1d55b0"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Tìm Kiếm" href="search.html" />
    <link rel="next" title="6. SQLCMD" href="p01-06-sqlcmd.html" />
    <link rel="prev" title="4. SQL style guide" href="p01-04-sql-style.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Khai thác dữ liệu với SQL
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">SQL cơ bản</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="p01-01-sql-co-ban.html">1. SQL cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-02-sql-nang-cao.html">2. SQL nâng cao</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-03-sql-tuning.html">3. SQL tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-04-sql-style.html">4. SQL style guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Mẹo với SQL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Kiểm-tra-kiểu-dữ-liệu-trong-bảng">5.1. Kiểm tra kiểu dữ liệu trong bảng</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Dữ-liệu-bị-collate">5.2. Dữ liệu bị collate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Drop-nhiều-bảng-theo-điều-kiện">5.3. Drop nhiều bảng theo điều kiện</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Auto-Wrap-in-MSSQL">5.4. Auto Wrap in MSSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Format-định-dạng-thêm-ký-tự-00-trước-số">5.5. Format định dạng thêm ký tự 00 trước số</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Kiểm-tra-định-dạng-dữ-liệu-một-bảng">5.6. Kiểm tra định dạng dữ liệu một bảng</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Convert-từ-tiếng-Việt-có-dấu-sang-không-dấu">5.7. Convert từ tiếng Việt có dấu sang không dấu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Functions-chọn-giá-trị-lớn-hơn">5.8. Functions chọn giá trị lớn hơn</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Procedure-pivot-vs.-unpivot">5.9. Procedure pivot vs. unpivot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Đổi-tên-bảng-và-tên-cột">5.10. Đổi tên bảng và tên cột</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Viết-hoa-chữ-đầu">5.11. Viết hoa chữ đầu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Tạo-floor-date">5.12. Tạo floor date</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Clean-city">5.13. Clean city</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Kiểm-tra-chất-lượng-dữ-liệu-hàng-ngày">5.14. Kiểm tra chất lượng dữ liệu hàng ngày</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Sửa-default-template-trong-SQL">5.15. Sửa default template trong SQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Bắt-đầu-têm-bảng-với-DIM">5.16. Bắt đầu têm bảng với DIM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Xóa-bảng-nếu-tồn-tại">5.17. Xóa bảng nếu tồn tại</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Tìm-kiếm-kiểu-dữ-liệu-trong-bảng-của-db">5.18. Tìm kiếm kiểu dữ liệu trong bảng của db</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Sử-dụng-drop-và-create-trong-cùng-batch">5.19. Sử dụng drop và create trong cùng batch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Phân-biệt-định-dạng-integer">5.20. Phân biệt định dạng integer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#VARCHAR-vs.-NVARCHAR">5.21. VARCHAR vs. NVARCHAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Primary-key-vs.-Unique-key">5.22. Primary key vs. Unique key</a></li>
<li class="toctree-l2"><a class="reference internal" href="#EXEC-vs.-EXEC()">5.23. EXEC vs. EXEC()</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Xem-tất-cả-các-user-defined-procedure">5.24. Xem tất cả các user-defined procedure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Làm-việc-với-link-server">5.25. Làm việc với link server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Procedure-tạo-nhiều-link-server">5.25.1. Procedure tạo nhiều link server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Tìm-tất-cả-các-bảng,-cột-trong-Database">5.26. Tìm tất cả các bảng, cột trong Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Chạy-file-.BAT-từ-T-SQL">5.27. Chạy file .BAT từ T-SQL</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="p01-06-sqlcmd.html">6. SQLCMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-07-sql-project.html">7. SQL prọject</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-08-sql-va-excel.html">8. Kết nối SQL với Excel phục vụ báo cáo tự động</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Khai thác dữ liệu với SQL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">5. </span>Mẹo với SQL</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/p01-05-tricks-sql.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Mẹo-với-SQL">
<h1><span class="section-number">5. </span>Mẹo với SQL<a class="headerlink" href="#Mẹo-với-SQL" title="Link to this heading"></a></h1>
<section id="Kiểm-tra-kiểu-dữ-liệu-trong-bảng">
<h2><span class="section-number">5.1. </span>Kiểm tra kiểu dữ liệu trong bảng<a class="headerlink" href="#Kiểm-tra-kiểu-dữ-liệu-trong-bảng" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">COLUMN_NAME</span><span class="p">,</span><span class="w"> </span><span class="n">DATA_TYPE</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">COLUMNS</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ACCOUNT&#39;</span><span class="w"> </span><span class="c1">-- Điền tên bảng</span>
</pre></div>
</div>
</section>
<section id="Dữ-liệu-bị-collate">
<h2><span class="section-number">5.2. </span>Dữ liệu bị collate<a class="headerlink" href="#Dữ-liệu-bị-collate" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Khi làm việc, dữ liệu các bảng có thể bị convert định dạng khác nhau. Trong trường hợp này, phải dùng <code class="docutils literal notranslate"><span class="pre">COLLATE</span> <span class="pre">DATABASE_DEFAULT</span></code></p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span>
<span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">columns</span>
<span class="k">where</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">DATABASE_DEFAULT</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">new_table</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">DATABASE_DEFAULT</span>
<span class="k">from</span><span class="w"> </span><span class="n">table_rename</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="Drop-nhiều-bảng-theo-điều-kiện">
<h2><span class="section-number">5.3. </span>Drop nhiều bảng theo điều kiện<a class="headerlink" href="#Drop-nhiều-bảng-theo-điều-kiện" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">string</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">STRING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">STRING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">STRING</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;DROP TABLE ANALYTICS.DBO.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;;&#39;</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">ANALYTICS</span><span class="p">.</span><span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">TABLES</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;Mckinsey%&#39;</span>
<span class="k">exec</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="n">string</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="Auto-Wrap-in-MSSQL">
<h2><span class="section-number">5.4. </span>Auto Wrap in MSSQL<a class="headerlink" href="#Auto-Wrap-in-MSSQL" title="Link to this heading"></a></h2>
<p>Tools &gt;&gt; Options &gt;&gt; Text Editor &gt;&gt; Transact SQL &gt;&gt; General &gt;&gt; WordWrap</p>
</section>
<section id="Format-định-dạng-thêm-ký-tự-00-trước-số">
<h2><span class="section-number">5.5. </span>Format định dạng thêm ký tự 00 trước số<a class="headerlink" href="#Format-định-dạng-thêm-ký-tự-00-trước-số" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">FORMAT</span><span class="p">(</span><span class="mi">01</span><span class="p">,</span><span class="s1">&#39;00#&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">index</span>
</pre></div>
</div>
</section>
<section id="Kiểm-tra-định-dạng-dữ-liệu-một-bảng">
<h2><span class="section-number">5.6. </span>Kiểm tra định dạng dữ liệu một bảng<a class="headerlink" href="#Kiểm-tra-định-dạng-dữ-liệu-một-bảng" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Với Link server</span>
<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">ANHNT67</span><span class="p">.</span><span class="k">DATA</span><span class="p">.</span><span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">COLUMNS</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="o">=</span><span class="s1">&#39;CARD_LIVE&#39;</span>

<span class="c1">-- Với Local</span>
<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">COLUMNS</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="o">=</span><span class="s1">&#39;CARD_LIVE&#39;</span>

<span class="c1">-- Kiểm tra toàn bộ thông tin</span>
<span class="n">sp_help</span><span class="w"> </span><span class="k">table_name</span>
<span class="n">sp_help</span><span class="w"> </span><span class="n">CARD_LIVE</span>
</pre></div>
</div>
</section>
<section id="Convert-từ-tiếng-Việt-có-dấu-sang-không-dấu">
<h2><span class="section-number">5.7. </span>Convert từ tiếng Việt có dấu sang không dấu<a class="headerlink" href="#Convert-từ-tiếng-Việt-có-dấu-sang-không-dấu" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">fChuyenCoDauThanhKhongDau</span><span class="p">](</span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="k">MAX</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="k">RETURNS</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="k">MAX</span><span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="s1">&#39;&#39;</span>

<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">RT</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="k">MAX</span><span class="p">)</span>
<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">SIGN_CHARS</span><span class="w"> </span><span class="k">NCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">UNSIGN_CHARS</span><span class="w"> </span><span class="k">NCHAR</span><span class="w"> </span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>

<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">SIGN_CHARS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="s1">&#39;ăâđêôơưàảãạáằẳẵặắầẩẫậấèẻẽẹéềểễệếìỉĩịíòỏõọóồổỗộốờởỡợớùủũụúừửữựứỳỷỹỵýĂÂĐÊÔƠƯÀẢÃẠÁẰẲẴẶẮẦẨẪẬẤÈẺẼẸÉỀỂỄỆẾÌỈĨỊÍÒỎÕỌÓỒỔỖỘỐỜỞỠỢỚÙỦŨỤÚỪỬỮỰỨỲỶỸỴÝ&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">NCHAR</span><span class="p">(</span><span class="mi">272</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">NCHAR</span><span class="p">(</span><span class="mi">208</span><span class="p">)</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">UNSIGN_CHARS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="s1">&#39;aadeoouaaaaaaaaaaaaaaaeeeeeeeeeeiiiiiooooooooooooooouuuuuuuuuuyyyyyAADEOOUAAAAAAAAAAAAAAAEEEEEEEEEEIIIIIOOOOOOOOOOOOOOOUUUUUUUUUUYYYYYDD&#39;</span>

<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER</span><span class="w"> </span><span class="nb">int</span>
<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER1</span><span class="w"> </span><span class="nb">int</span>

<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="n">WHILE</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="n">COUNTER</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">LEN</span><span class="p">(</span><span class="o">@</span><span class="n">inputVar</span><span class="p">))</span>
<span class="w">    </span><span class="k">BEGIN</span>
<span class="w">        </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">WHILE</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="n">COUNTER1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">LEN</span><span class="p">(</span><span class="o">@</span><span class="n">SIGN_CHARS</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">BEGIN</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="n">UNICODE</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">SIGN_CHARS</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UNICODE</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">inputVar</span><span class="p">,</span><span class="o">@</span><span class="n">COUNTER</span><span class="w"> </span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="k">BEGIN</span>
<span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">UNSIGN_CHARS</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">inputVar</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">LEN</span><span class="p">(</span><span class="o">@</span><span class="n">inputVar</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="k">ELSE</span>
<span class="w">                    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">inputVar</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">UNSIGN_CHARS</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">inputVar</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">LEN</span><span class="p">(</span><span class="o">@</span><span class="n">inputVar</span><span class="p">)</span><span class="o">-</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER</span><span class="p">)</span>
<span class="w">                </span><span class="n">BREAK</span>
<span class="w">            </span><span class="k">END</span>
<span class="w">            </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER1</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span>
<span class="w">        </span><span class="k">END</span>
<span class="w">        </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">COUNTER</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span>
<span class="w">    </span><span class="k">END</span>
<span class="w">    </span><span class="c1">-- SET @inputVar = replace(@inputVar,&#39; &#39;,&#39;-&#39;)</span>
<span class="w">    </span><span class="k">RETURN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span>
<span class="k">END</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Ví dụ</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">fChuyenCoDauThanhKhongDau</span><span class="p">(</span><span class="n">N</span><span class="s1">&#39;Một thiên thần&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="Functions-chọn-giá-trị-lớn-hơn">
<h2><span class="section-number">5.8. </span>Functions chọn giá trị lớn hơn<a class="headerlink" href="#Functions-chọn-giá-trị-lớn-hơn" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************</span>
<span class="cm">Script:         Function lấy giá trị lớn hơn</span>
<span class="cm">Author:         TrangTQ2</span>
<span class="cm">Created date:   20190301</span>
<span class="cm">Modifed date:</span>
<span class="cm">========================================</span>
<span class="cm">Description: Tạo fuction lấy giá trị lớn hơn trong 2 số</span>

<span class="cm">*********************************/</span>

<span class="k">create</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">GREATER</span><span class="p">](</span><span class="o">@</span><span class="n">val1</span><span class="w"> </span><span class="nb">FLOAT</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">val2</span><span class="w"> </span><span class="nb">FLOAT</span><span class="p">)</span>
<span class="k">returns</span><span class="w"> </span><span class="nb">FLOAT</span>
<span class="k">as</span>
<span class="k">begin</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">@</span><span class="n">val1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">@</span><span class="n">val2</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">@</span><span class="n">val1</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">isnull</span><span class="p">(</span><span class="o">@</span><span class="n">val2</span><span class="p">,</span><span class="o">@</span><span class="n">val1</span><span class="p">)</span>
<span class="k">end</span>
<span class="k">GO</span>
</pre></div>
</div>
</section>
<section id="Procedure-pivot-vs.-unpivot">
<h2><span class="section-number">5.9. </span>Procedure pivot vs. unpivot<a class="headerlink" href="#Procedure-pivot-vs.-unpivot" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************</span>
<span class="cm">Script:         Procedure pivot và unpivot</span>
<span class="cm">Author:         TrangTQ2</span>
<span class="cm">Created date:   20190301</span>
<span class="cm">Modifed date:</span>
<span class="cm">========================================</span>
<span class="cm">Description: Tạo procedure pivot và unpivot trong SQL với concept giống dcast và melt trong R</span>

<span class="cm">*********************************/</span>

<span class="c1">---------------------------------------------------------CREATE DATA TO TEST---------------------------------------------------</span>

<span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">##</span><span class="n">student_wide</span>
<span class="p">(</span>
<span class="n">id</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="n">mark1</span><span class="w"> </span><span class="nb">float</span><span class="p">,</span>
<span class="n">mark2</span><span class="w"> </span><span class="nb">float</span><span class="p">,</span>
<span class="n">mark3</span><span class="w"> </span><span class="nb">float</span>
<span class="p">)</span>

<span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">##</span><span class="n">student_wide</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">##</span><span class="n">student_wide</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">##</span><span class="n">student_wide</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">student_wide</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">into</span><span class="w"> </span><span class="o">##</span><span class="n">student_long</span><span class="w"> </span><span class="k">FROM</span>
<span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="o">##</span><span class="n">student_wide</span><span class="p">)</span><span class="w"> </span><span class="n">a</span>
<span class="n">UNPIVOT</span>
<span class="p">(</span><span class="n">value_var</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="n">group_var</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">([</span><span class="n">mark1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">mark2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">mark3</span><span class="p">])</span>
<span class="p">)</span><span class="w"> </span><span class="n">b</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">student_long</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span>
<span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">student_long</span><span class="p">)</span><span class="w"> </span><span class="n">a</span>
<span class="n">pivot</span>
<span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">value_var</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">group_var</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">([</span><span class="n">mark1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">mark2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">mark3</span><span class="p">]))</span><span class="w"> </span><span class="n">b</span>

<span class="c1">---------------------------------------------------CREATE PROCEDURE TO PIVOT---------------------------------------------</span>

<span class="c1">--drop procedure if exists sql_pivot</span>
<span class="k">create</span><span class="w"> </span><span class="k">procedure</span><span class="w"> </span><span class="n">sql_pivot</span><span class="w">  </span><span class="o">@</span><span class="k">data</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">),</span>
<span class="w">                            </span><span class="o">@</span><span class="k">group</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Variable to pivot</span>
<span class="w">                            </span><span class="o">@</span><span class="k">row</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Column to keep as key</span>
<span class="w">                            </span><span class="o">@</span><span class="n">value</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Column to calculate</span>
<span class="w">                            </span><span class="o">@</span><span class="k">function</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Function to calculate</span>
<span class="w">                            </span><span class="o">@</span><span class="n">stored_data</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;##pivot_result&#39;</span><span class="w"> </span><span class="c1">-- Store data result</span>
<span class="k">as</span>
<span class="k">begin</span>
<span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">declare @group_value nvarchar(max)</span>
<span class="s1">set @group_value = STUFF(</span>
<span class="s1">(SELECT &#39;&#39;,&#39;&#39; + &#39;&#39;[&#39;&#39; + b.&#39;</span><span class="o">+@</span><span class="k">group</span><span class="o">+</span><span class="s1">&#39; + &#39;&#39;]&#39;&#39;</span>
<span class="s1">              FROM</span>
<span class="s1">              (select distinct &#39;</span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="k">group</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39; from &#39;</span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="k">data</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;) b</span>
<span class="s1">              FOR XML PATH (&#39;&#39;&#39;&#39;)),1,1,&#39;&#39;&#39;&#39;)</span>

<span class="s1">declare @sqlstr nvarchar(max)</span>
<span class="s1">set @sqlstr = N&#39;&#39;</span>
<span class="s1">drop table if exists &#39;</span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="n">stored_data</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;</span>
<span class="s1">select *</span>
<span class="s1">into &#39;</span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="n">stored_data</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;</span>
<span class="s1">from</span>
<span class="s1">(select &#39;</span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="k">group</span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;, &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="k">row</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;, &#39;</span><span class="o">+@</span><span class="n">value</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;  from &#39;</span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="k">data</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;) a</span>
<span class="s1">pivot</span>
<span class="s1">(&#39;</span><span class="o">+@</span><span class="k">function</span><span class="o">+</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="n">value</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;) for &#39;</span><span class="o">+@</span><span class="k">group</span><span class="o">+</span><span class="s1">&#39; in (&#39;&#39; + @group_value + &#39;&#39;)) b</span>
<span class="s1">&#39;&#39;</span>
<span class="s1">exec sp_executesql @sqlstr</span>
<span class="s1">&#39;</span>
<span class="k">exec</span><span class="w"> </span><span class="n">sp_executesql</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span>
<span class="k">end</span><span class="p">;</span>


<span class="n">sql_pivot</span><span class="w"> </span><span class="o">@</span><span class="k">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;##student_long&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="o">@</span><span class="k">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="o">@</span><span class="k">group</span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;group_var&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="o">@</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;value_var&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="o">@</span><span class="k">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;sum&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="o">@</span><span class="n">stored_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;##student_wide2&#39;</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">student_long</span>
<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">pivot_result</span>
<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">student_wide2</span>

<span class="c1">---------------------------------------------------CREATE PROCEDURE TO UNPIVOT---------------------------------------------</span>

<span class="c1">--drop procedure if exists sql_unpivot</span>
<span class="k">create</span><span class="w"> </span><span class="k">procedure</span><span class="w"> </span><span class="n">sql_unpivot</span>
<span class="w"> </span><span class="o">@</span><span class="n">db</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tempdb&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">--Database contains data</span>
<span class="o">@</span><span class="k">data</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Name of data</span>
<span class="o">@</span><span class="n">id_var</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Key variables</span>
<span class="o">@</span><span class="n">group_var</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;group_var&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">--Name of groups variable</span>
<span class="o">@</span><span class="n">value_var</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;value_var&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Name of value variable</span>
<span class="o">@</span><span class="n">stored_data</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;##unpivot_result&#39;</span><span class="w">  </span><span class="c1">-- Data storage</span>
<span class="k">as</span>
<span class="k">begin</span>
<span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="s1">&#39;</span>
<span class="s1">drop table if exists ##all_cols</span>
<span class="s1">select name into ##all_cols</span>
<span class="s1">from &#39;</span><span class="o">+@</span><span class="n">db</span><span class="o">+</span><span class="s1">&#39;.sys.columns</span>
<span class="s1">where object_id in (select object_id from &#39;</span><span class="o">+@</span><span class="n">db</span><span class="o">+</span><span class="s1">&#39;.sys.tables where name like &#39;&#39;%&#39;</span><span class="o">+@</span><span class="k">data</span><span class="o">+</span><span class="s1">&#39;&#39;&#39;)</span>

<span class="s1">declare @cols AS NVARCHAR(MAX)</span>
<span class="s1">   select @cols = STUFF((SELECT &#39;&#39;,&#39;&#39; + QUOTENAME(name)</span>
<span class="s1">                    FROM (</span>
<span class="s1">                        select name from ##all_cols</span>
<span class="s1">                        where name not in (&#39;</span><span class="o">+@</span><span class="n">id_var</span><span class="o">+</span><span class="s1">&#39;)</span>
<span class="s1">                        ) cols</span>
<span class="s1">                    FOR XML PATH(&#39;&#39;&#39;&#39;), TYPE).value(&#39;&#39;.&#39;&#39;, &#39;&#39;NVARCHAR(MAX)&#39;&#39;),1,1,&#39;&#39;&#39;&#39;)</span>
<span class="s1">-- Show columns</span>
<span class="s1">print @cols</span>

<span class="s1">declare @key AS NVARCHAR(MAX)</span>
<span class="s1">   select @key = STUFF((SELECT &#39;&#39;,&#39;&#39; + QUOTENAME(name)</span>
<span class="s1">                    FROM (</span>
<span class="s1">                        select name from ##all_cols</span>
<span class="s1">                        where name in (&#39;</span><span class="o">+@</span><span class="n">id_var</span><span class="o">+</span><span class="s1">&#39;)</span>
<span class="s1">                        ) cols</span>
<span class="s1">                    FOR XML PATH(&#39;&#39;&#39;&#39;), TYPE).value(&#39;&#39;.&#39;&#39;, &#39;&#39;NVARCHAR(MAX)&#39;&#39;),1,1,&#39;&#39;&#39;&#39;)</span>
<span class="s1">-- Show key</span>
<span class="s1">print @key</span>

<span class="s1">--Run procedure</span>

<span class="s1">declare @sqlstr nvarchar(max)</span>
<span class="s1">set @sqlstr = N&#39;&#39;</span>
<span class="s1">            drop table if exists &#39;</span><span class="o">+@</span><span class="n">stored_data</span><span class="o">+</span><span class="s1">&#39;</span>
<span class="s1">            select &#39;&#39;+@key+&#39;&#39;, &#39;</span><span class="o">+@</span><span class="n">group_var</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+@</span><span class="n">value_var</span><span class="o">+</span><span class="s1">&#39;</span>
<span class="s1">            into &#39;</span><span class="o">+@</span><span class="n">stored_data</span><span class="o">+</span><span class="s1">&#39;</span>
<span class="s1">            from(</span>
<span class="s1">               select *</span>
<span class="s1">               from &#39;</span><span class="o">+@</span><span class="n">db</span><span class="o">+</span><span class="s1">&#39;.dbo.[&#39;</span><span class="o">+@</span><span class="k">data</span><span class="o">+</span><span class="s1">&#39;]</span>
<span class="s1">            ) as a</span>
<span class="s1">            unpivot</span>
<span class="s1">            (</span>
<span class="s1">              &#39;</span><span class="o">+@</span><span class="n">value_var</span><span class="o">+</span><span class="s1">&#39; for &#39;</span><span class="o">+@</span><span class="n">group_var</span><span class="o">+</span><span class="s1">&#39; in (&#39;&#39; + @cols + &#39;&#39;)</span>
<span class="s1">            ) as b</span>
<span class="s1">            select * from &#39;</span><span class="o">+@</span><span class="n">stored_data</span><span class="o">+</span><span class="s1">&#39;</span>
<span class="s1">            &#39;&#39;</span>
<span class="s1">print @sqlstr</span>
<span class="s1">exec sp_executesql @sqlstr</span>
<span class="s1">&#39;</span>
<span class="k">exec</span><span class="w"> </span><span class="n">sp_executesql</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span>
<span class="k">end</span>

<span class="n">sql_unpivot</span><span class="w"> </span><span class="o">@</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tempdb&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="o">@</span><span class="k">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;##student_wide&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="o">@</span><span class="n">id_var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;id&#39;&#39;&#39;</span><span class="p">,</span><span class="w">  </span><span class="c1">--&gt; neu muon giu nhieu cot thi viet &#39;&#39;&#39;id&#39;&#39;,&#39;&#39;mark1&#39;&#39;&#39;</span>
<span class="w">          </span><span class="o">@</span><span class="n">stored_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;##unpivot_result&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="o">@</span><span class="n">group_var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;group_mark&#39;</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">student_wide</span>
<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">unpivot_result</span>
<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">student_long</span>
</pre></div>
</div>
</section>
<section id="Đổi-tên-bảng-và-tên-cột">
<h2><span class="section-number">5.10. </span>Đổi tên bảng và tên cột<a class="headerlink" href="#Đổi-tên-bảng-và-tên-cột" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************</span>
<span class="cm">Script:         Đổi tên bảng và cột</span>
<span class="cm">Author:         TrangTQ2</span>
<span class="cm">Created date:   20190301</span>
<span class="cm">Modifed date:</span>
<span class="cm">========================================</span>
<span class="cm">Description:</span>

<span class="cm">*********************************/</span>

<span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">##</span><span class="n">test</span>
<span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">draft</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">test</span>
<span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">draft</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">test2</span>

<span class="k">select</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">##</span><span class="n">test</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">m74</span><span class="p">.</span><span class="n">bicdata</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">customer</span>
<span class="k">select</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">draft</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">test</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">m74</span><span class="p">.</span><span class="n">bicdata</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">customer</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">##</span><span class="n">test</span>
<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">draft</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">test2</span>

<span class="c1">-- Đổi tên bảng (không đổi được tên bảng tạm)</span>

<span class="n">use</span><span class="w"> </span><span class="n">DBS_REGULAR</span>
<span class="k">go</span>
<span class="n">sp_rename</span><span class="w"> </span><span class="s1">&#39;PCB_UPLTOPUP_FULL_201806&#39;</span><span class="p">,</span><span class="s1">&#39;PCB_UPLTOPUP_FULL&#39;</span>
<span class="k">go</span>

<span class="c1">-- Đổi tên cột</span>
<span class="n">use</span><span class="w"> </span><span class="n">DBS_ADHOC</span>
<span class="k">go</span>
<span class="n">sp_rename</span><span class="w"> </span><span class="s1">&#39;EBANKING_TRANSACTION_2017.TRANS_TYPE&#39;</span><span class="p">,</span><span class="s1">&#39;TYPE&#39;</span><span class="p">,</span><span class="s1">&#39;column&#39;</span>
<span class="c1">--tempdb.sys.sp_rename &#39;##test.RECID&#39;,&#39;CIF&#39;,&#39;column&#39;</span>
<span class="k">go</span>
</pre></div>
</div>
</section>
<section id="Viết-hoa-chữ-đầu">
<h2><span class="section-number">5.11. </span>Viết hoa chữ đầu<a class="headerlink" href="#Viết-hoa-chữ-đầu" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************</span>
<span class="cm">Script:         Function viết hoa chữ đầu</span>
<span class="cm">Author:         TrangTQ2</span>
<span class="cm">Created date:   20190301</span>
<span class="cm">Modifed date:</span>
<span class="cm">========================================</span>
<span class="cm">Description: Tạo function viết hoa chữ cái đầu</span>

<span class="cm">*********************************/</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">fn_capitalize</span>
<span class="p">(</span>
<span class="o">@</span><span class="n">str</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">RETURNS</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>

<span class="k">DECLARE</span>
<span class="o">@</span><span class="n">ret_str</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="o">@</span><span class="n">pos</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="o">@</span><span class="n">len</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span>

<span class="k">SELECT</span>
<span class="o">@</span><span class="n">ret_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">LOWER</span><span class="p">(</span><span class="o">@</span><span class="n">str</span><span class="p">),</span>
<span class="o">@</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="o">@</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LEN</span><span class="p">(</span><span class="o">@</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>

<span class="n">WHILE</span><span class="w"> </span><span class="o">@</span><span class="n">pos</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="o">@</span><span class="n">pos</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">@</span><span class="n">len</span>
<span class="k">BEGIN</span>
<span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">ret_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STUFF</span><span class="p">(</span><span class="o">@</span><span class="n">ret_str</span><span class="p">,</span>
<span class="o">@</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="mi">1</span><span class="p">,</span>
<span class="k">UPPER</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">(</span><span class="o">@</span><span class="n">ret_str</span><span class="p">,</span><span class="o">@</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span>
<span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CHARINDEX</span><span class="p">(</span><span class="n">N</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">ret_str</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="k">END</span>

<span class="k">RETURN</span><span class="w"> </span><span class="k">RIGHT</span><span class="p">(</span><span class="o">@</span><span class="n">ret_str</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="k">END</span>

<span class="c1">------</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">fn_capitalize</span><span class="p">(</span><span class="s1">&#39;Average Spending per Transaction&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="Tạo-floor-date">
<h2><span class="section-number">5.12. </span>Tạo floor date<a class="headerlink" href="#Tạo-floor-date" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************</span>
<span class="cm">Script:         Floor Date trong SQL</span>
<span class="cm">Author:         AnhHD3</span>
<span class="cm">Created date:   20190412</span>
<span class="cm">Modifed date:</span>
<span class="cm">========================================</span>
<span class="cm">Description:  Hàm cho phép lấy nhanh ngày đầu tiên</span>
<span class="cm">của tháng, năm, cho phép tính toán và nhóm theo month/year</span>
<span class="cm">*********************************/</span>

<span class="k">IF</span><span class="w"> </span><span class="n">OBJECT_ID</span><span class="p">(</span><span class="s1">&#39;fn_FloorDate&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">fn_FloorDate</span>
<span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">OFF</span>
<span class="k">GO</span>
<span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span>
<span class="k">GO</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">fn_FloorDate</span><span class="p">]</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="o">@</span><span class="nb">Date</span><span class="w"> </span><span class="n">DATETIME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">  </span><span class="o">@</span><span class="n">DatePart</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;day&#39;</span>
<span class="p">)</span>
<span class="k">RETURNS</span><span class="w"> </span><span class="n">DATETIME</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
<span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="nb">Date</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="nb">Date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GETDATE</span><span class="p">();</span>

<span class="w">  </span><span class="k">RETURN</span>
<span class="w">  </span><span class="k">CASE</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="k">LOWER</span><span class="p">(</span><span class="o">@</span><span class="n">DatePart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;year&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">DATEADD</span><span class="p">(</span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">YEAR</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="nb">Date</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="k">LOWER</span><span class="p">(</span><span class="o">@</span><span class="n">DatePart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;month&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">DATEADD</span><span class="p">(</span><span class="k">MONTH</span><span class="p">,</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">MONTH</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="nb">Date</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="k">LOWER</span><span class="p">(</span><span class="o">@</span><span class="n">DatePart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;day&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">DATEADD</span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="nb">Date</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="k">LOWER</span><span class="p">(</span><span class="o">@</span><span class="n">DatePart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hour&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">DATEADD</span><span class="p">(</span><span class="n">HOUR</span><span class="p">,</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="n">HOUR</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="nb">Date</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="k">LOWER</span><span class="p">(</span><span class="o">@</span><span class="n">DatePart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;minute&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">DATEADD</span><span class="p">(</span><span class="k">MINUTE</span><span class="p">,</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">MINUTE</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="nb">Date</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="k">LOWER</span><span class="p">(</span><span class="o">@</span><span class="n">DatePart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;second&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">DATEADD</span><span class="p">(</span><span class="k">SECOND</span><span class="p">,</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">SECOND</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="nb">Date</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">ELSE</span><span class="w"> </span><span class="n">DATEADD</span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="k">DAY</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="nb">Date</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="k">END</span><span class="p">;</span>
<span class="k">END</span>

<span class="c1">-- Example</span>

<span class="k">select</span><span class="w"> </span><span class="n">getdate</span><span class="p">()</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">fn_FloorDate</span><span class="p">(</span><span class="n">getdate</span><span class="p">(),</span><span class="w"> </span><span class="s1">&#39;month&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="Clean-city">
<h2><span class="section-number">5.13. </span>Clean city<a class="headerlink" href="#Clean-city" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************</span>
<span class="cm">Script:         Function clean city</span>
<span class="cm">Author:         Hoangnb3</span>
<span class="cm">Created date:   20190426</span>
<span class="cm">Modifed date:</span>
<span class="cm">========================================</span>
<span class="cm">Description: Tạo function làm sạch dữ liệu tỉnh/thành phố trực thuộc trung ương</span>

<span class="cm">Note: Sử dụng sau khi đã dùng function chuyển sang không dấu</span>

<span class="cm">*********************************/</span>

<span class="n">USE</span><span class="w"> </span><span class="p">[</span><span class="n">master</span><span class="p">]</span>
<span class="k">GO</span>

<span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span>
<span class="k">GO</span>
<span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span>
<span class="k">GO</span>

<span class="k">ALTER</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">fn_cleancity</span><span class="p">](</span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="k">MAX</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="k">returns</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">as</span>
<span class="k">begin</span>
<span class="w">    </span><span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="n">city_new</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>

<span class="w">    </span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="n">city_new</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha%no%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha%n%i%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha dong%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hn%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hn&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hn&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%h anoi%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hanoi%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha n oi%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha ná»i%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha nnoi%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha no%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha npoi%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha tay%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hã  ná»?i%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hã¡ noi%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ba vi%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%gia lam%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha hoi%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hoan kiem%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Van Chuong%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Trung Kinh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Trung Hoa%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Quoc Oai%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Van Dien%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Thach That%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Cau Giay%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Hoang Mai%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Phu Do%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Me Linh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ba Dinh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Quoc Oai%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ha noi&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%chi%minh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hcm%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%quan 1%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%há»? chã­ minh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%tp h cm%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%tan phu%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%thu duc%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%go vap%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tan Binh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Chi Hoa%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Hoc Mon%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tan Thuan Dong%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Binh Hung Hoa%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ap Sai Gon%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Cu Chi%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Phu Nhuan%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Binh Tan%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Nha Be%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Linh Xuan%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Trung My Tay%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ho chi minh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%quang%ninh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%mong cai%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%quag ninh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha long%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dong trieu%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Van Don%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Quang Yen%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Q%Ninh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tien Yen%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Hoanh Bo%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%cam pha%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;quang ninh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%quang binh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%quangb binh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%q%binh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Hoan Lao%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Dong Hoi%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%qbinh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;quang binh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%quang tri%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%quangtri%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%q%tr%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%quáº£ng tri%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Trieu Phong%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ho Xa%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Dong Ha%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;quang tri&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hue%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Phu Loc%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%th%hu%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;hue&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%tien giang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%t%giang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%My Tho%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Cai Be%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Go Cong%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%tiá»n giang%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;tien giang&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%b%tre%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Mo Cay%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Giong Trom%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ben tre%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ben tre&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ca mau%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ca mau&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%binh phuoc%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Dong Xoai%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Binh Long%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Loc Ninh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%binh%ph%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;binh phuoc&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%binh dinh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%binh%d%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%An Nhon%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Bong Son%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Qu%Nhon%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;binh dinh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%phu tho%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%phutho%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%phu%th%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Cam Khe%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%viet tri%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;phu tho&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%an%giang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%An Phu%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tan Chau%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Long Xuyen%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;an giang&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%yen bai%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Yen Binh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;yen bai&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%son la%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Moc Chau%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;son la&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%tay ninh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ben Cau%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Trang Bang%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;tay ninh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%vung%tau%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ba ria- vå©ng tã u&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ba Ria%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Xuyen Moc%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;vung tau&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%bac can%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%b%c%c%n%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%b%c%k%n%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%bac kan%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;bac can&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%b%lieu%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Gia Rai%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;bac lieu&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%bac ninh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%b%ninh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%yen trung%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tu Son%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Gia Binh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Thuan Thanh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;bac ninh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%binh duong%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Thuan An%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tan Uyen%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ben Cat%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Thu Dau Mot%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;binh duong&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha nam%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ly Nhan%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Kim Bang%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Phu%L%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ha nam&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%binh thuan%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%phan thiet%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%binh%th%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Duc Linh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;phãº thá»&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;binh thuan&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%can tho%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%c%tho%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Phong Dien%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Xuan Khanh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;can tho&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hau giang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%h%giang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Phung Hiep%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Rach Goi%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Vi Thanh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;hau giang&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%tuyen quang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Chiem Hoa%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%tuyãªn quang%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;tuyen quang&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%thai nguyen%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Phu Dinh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%thainguyen%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;thai nguyen&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%thai binh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Hung Ha%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tien Hai%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%thai bã¬nh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;thai binh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hai phong%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%h%ph%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%An Bien%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Kien An%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hp%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;hai phong&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%da nang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%da%n%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;da nã¢ng&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%d%nang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Lien Chieu%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Hai Chau%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Son Tra%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Cam Le%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Hoa Vang%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;cam ranh&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;da nang&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dac lac%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%d%c%l%c%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dak dak%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dak lak%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dakalk%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dakalk%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%daklak%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dallak%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%buon ma thuot%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ban Me Thuot%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Buon Don%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;dac lac&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dac nong%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%d%nong%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Gia Nghia%&#39;</span>
<span class="w">                            </span><span class="k">OR</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dak nong%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;dac nong&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%bac giang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%b%giang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%yen the%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Hiep Hoa%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Viet Yen%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;bac giang&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%bac ninh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Yen Phong%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Luong Tai%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ban ninh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;bac ninh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dong nai%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%d%nai%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Long Thanh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Long Khanh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ho Nai%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Bien Hoa%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;dong nai&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%vinh long%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tra On%&#39;</span>
<span class="w">                            </span><span class="k">OR</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%vfinh long%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;vinh long&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%lai chau%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;lai chau&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%lam dong%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%lam%d%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Bao Loc%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Da Lat%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;lam dong&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%lang son%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%l%son%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Van Linh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Xuan Tinh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;lang son&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%lao cai%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;lao cai&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dong nai%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Xuan Loc%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;dong nai&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%tay ninh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Phuoc Dong%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;tay ninh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ninh binh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ninh binh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha giang%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha ginag%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ha giang&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%thanh hoa%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%thanh oai%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%thanh ho%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Yen Dinh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Bim Son%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Nong Cong%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tho Xuan%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Quang Xuong%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;thanh hoa&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%tra%vinh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tieu Can%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Duyen Hai%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;tra vinh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha tinh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha ti nh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ha tin%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hã¡ tinh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hat inh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ha tinh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%nghe an%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%nghá»? an%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%vinh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ngh%an%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Dien Chau%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Quynh Luu%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Do Luong%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Minh Son%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Yen Thanh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;nghe an&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%nam dinh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%nam dinnh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%nam%d%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Vu Ban%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%yen thang%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;nam dinh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hai duong%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Kinh Mon%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Cam Giang%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%h%duong%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;hai duong&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hoa binh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hoabinh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;hoa binh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%hung yen%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Yen My%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Khoai Chau%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tien Lu%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Van Lam%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;hung yen&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%kien giang%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Rach Gia%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Duong Dong%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%phu quoc%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%kie giang%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;kien giang&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%kon tum%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%kom tum%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;kon tum&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%khanh hoa%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%khanh hioa%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%nha trang%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Cam Lam%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ninh Hoa%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Dien Khanh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;khanh hoa&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%vinh phuc%&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%phuc yen%&#39;</span>
<span class="w">                            </span><span class="k">OR</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Yen Lac%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;vinh phuc&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%long an%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%lon gan%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tan Tru%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tan An%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Ben Luc%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Can Giuoc%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Can Duoc%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%An Thanh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tan Hung%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Moc Hoa%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%lon gan%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;long an&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dong nai%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Dinh Quan%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;dong nai&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ninh binh%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ninhbinh%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ninh binh&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%ninh%th%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Phan Rang%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ninh thuan&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%soc trang%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;soc trang&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%phu yen%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tay Hoa%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tuy Hoa%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;phu yen&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%cao%b%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;cao bang&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%d%bien%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;dien bien&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%dong thap%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Cao Lanh%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Hong Ngu%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Sa Dec%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%d%thap%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;dong thap&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%gia lai%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Phu Tuc%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Chu Se%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Pleiku%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;gia lai&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Q%Nam%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Tam Ky%&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Duy Xuyen%&#39;</span>
<span class="w">                            </span><span class="k">or</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Hoi An%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;quang nam&#39;</span>
<span class="w">                        </span><span class="k">WHEN</span><span class="w"> </span><span class="o">@</span><span class="n">inputVar</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Q%Ngai%&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;quang ngai&#39;</span>
<span class="w">                        </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;Others&#39;</span>
<span class="w">                        </span><span class="k">END</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">@</span><span class="n">city_new</span>
<span class="k">end</span>
</pre></div>
</div>
</section>
<section id="Kiểm-tra-chất-lượng-dữ-liệu-hàng-ngày">
<h2><span class="section-number">5.14. </span>Kiểm tra chất lượng dữ liệu hàng ngày<a class="headerlink" href="#Kiểm-tra-chất-lượng-dữ-liệu-hàng-ngày" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************</span>
<span class="cm">Script: Tạo bảng kiểm tra chất lượng dữ liệu (nrow) hàng ngày</span>
<span class="cm">Author:         AnhHD3</span>
<span class="cm">Created date:   20180701</span>
<span class="cm">========================================</span>
<span class="cm">Step 1: Sửa tên Database cho phù hợp</span>
<span class="cm">Step 2: Run hoặc tạo job hàng ngày</span>
<span class="cm">*/</span>

<span class="c1">-- Step 1: Tạo bảng TABLE_QUALITY</span>

<span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">DATA</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">TABLE_QUALITY</span>
<span class="p">(</span>
<span class="k">TABLE_NAME</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="n">N_ROW</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span>

<span class="c1">-- Step 2: Update số dòng trong bảng (chỉ dùng bảng mới)</span>

<span class="k">declare</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="k">select</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">INSERT INTO DATA.dbo.TABLE_QUALITY (TABLE_NAME, N_ROW)</span>
<span class="s1">select &#39;&#39;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;, count(1) as N_ROW from DATA.dbo.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">&#39;</span>
<span class="k">from</span><span class="w"> </span><span class="k">DATA</span><span class="p">.</span><span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">tables</span>
<span class="k">where</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">table_quality</span><span class="p">)</span>
<span class="n">print</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span>
<span class="k">exec</span><span class="p">(</span><span class="o">@</span><span class="k">sql</span><span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="k">DATA</span><span class="p">..</span><span class="n">TABLE_QUALITY</span>
</pre></div>
</div>
</section>
<section id="Sửa-default-template-trong-SQL">
<h2><span class="section-number">5.15. </span>Sửa default template trong SQL<a class="headerlink" href="#Sửa-default-template-trong-SQL" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Sửa file <code class="docutils literal notranslate"><span class="pre">SQLfile.sql</span></code> tại đường dẫn sau <code class="docutils literal notranslate"><span class="pre">C:\Program</span> <span class="pre">Files</span> <span class="pre">(x86)\Microsoft</span> <span class="pre">SQL</span> <span class="pre">Server\130\Tools\Binn\ManagementStudio\SqlWorkbenchProjectItems\Sql</span></code></p></li>
<li><p>Nội dung default script</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="cm">/********************************</span>
<span class="cm">Script:         Giao dịch Ebanking</span>
<span class="cm">Author:         AnhHD3</span>
<span class="cm">Created date:   20180701</span>
<span class="cm">Modifed date:   20181127</span>
<span class="cm">========================================</span>
<span class="cm">Description: Create Data Preparation</span>
<span class="cm">for datamart</span>
<span class="cm">========================================</span>
<span class="cm">Affected tables:</span>
<span class="cm">    - [dbo].[POS_ECOMCARD_2017]</span>

<span class="cm">Steps:</span>
<span class="cm">    - Step 1: Declare date</span>
<span class="cm">    - Step 2:</span>
<span class="cm">        - POS transaction</span>
<span class="cm">        - ATM/CDM transaction</span>
<span class="cm">*********************************/</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">TOP</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">XXX</span>
</pre></div>
</div>
</section>
<section id="Bắt-đầu-têm-bảng-với-DIM">
<h2><span class="section-number">5.16. </span>Bắt đầu têm bảng với DIM<a class="headerlink" href="#Bắt-đầu-têm-bảng-với-DIM" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Tên các bảng thường bắt đầu bằng Dim - viết tắt của Dimension</p></li>
</ul>
</section>
<section id="Xóa-bảng-nếu-tồn-tại">
<h2><span class="section-number">5.17. </span>Xóa bảng nếu tồn tại<a class="headerlink" href="#Xóa-bảng-nếu-tồn-tại" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">CROSS_SELLING_RESULTS</span>
</pre></div>
</div>
</section>
<section id="Tìm-kiếm-kiểu-dữ-liệu-trong-bảng-của-db">
<h2><span class="section-number">5.18. </span>Tìm kiếm kiểu dữ liệu trong bảng của db<a class="headerlink" href="#Tìm-kiếm-kiểu-dữ-liệu-trong-bảng-của-db" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Kiểm tra thông tin kiểu dữ liệu trong bảng</span>
<span class="k">select</span><span class="w"> </span><span class="k">table_name</span><span class="p">,</span><span class="w"> </span><span class="k">column_name</span><span class="p">,</span><span class="w"> </span><span class="n">data_type</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">[</span><span class="n">learningsql</span><span class="p">].[</span><span class="n">INFORMATION_SCHEMA</span><span class="p">].[</span><span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="Sử-dụng-drop-và-create-trong-cùng-batch">
<h2><span class="section-number">5.19. </span>Sử dụng drop và create trong cùng batch<a class="headerlink" href="#Sử-dụng-drop-và-create-trong-cùng-batch" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>DROP và CREATE không thể chạy cùng trong 1 batch, khi muốn sử dụng phải thêm câu lệnh GO</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="o">#</span><span class="n">temp</span>
<span class="k">GO</span>

<span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">#</span><span class="n">temp</span><span class="p">(</span><span class="n">abc</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span>
<span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="o">#</span><span class="n">temp</span><span class="p">(</span><span class="n">abc</span><span class="p">)</span>
<span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="k">GO</span>
</pre></div>
</div>
</section>
<section id="Phân-biệt-định-dạng-integer">
<h2><span class="section-number">5.20. </span>Phân biệt định dạng integer<a class="headerlink" href="#Phân-biệt-định-dạng-integer" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>SQL không phân biệt được định dạng numeric &amp; integer ngay lập tức</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="w">  </span><span class="c1">-- Trả kết quả 0</span>

<span class="c1">--So sánh</span>

<span class="k">select</span><span class="w"> </span><span class="mi">7</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">10</span><span class="w"> </span><span class="c1">-- Chạy đúng</span>
</pre></div>
</div>
</section>
<section id="VARCHAR-vs.-NVARCHAR">
<h2><span class="section-number">5.21. </span>VARCHAR vs. NVARCHAR<a class="headerlink" href="#VARCHAR-vs.-NVARCHAR" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>varchar vs. nvarchar: nvarchar cho phép lưu trữ ký tự Unicode, varchar không cho phép</p></li>
<li><p>varchar(n) vs. varchar(max):</p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>varchar(n)
</pre></div>
</div>
</th>
<th class="head"><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>varchar(max)
</pre></div>
</div>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Tối đa 8000 ký tự</p></td>
<td><p>Tối đa hơn 2 tỷ, khoảng 2G</p></td>
</tr>
<tr class="row-odd"><td><p>Cho phép tạo index</p></td>
<td><p>Không cho phép tạo index</p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">--Varchar(50): Work</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">Employee</span>
<span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">identity</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">   </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="k">GO</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">IX_EmployeeName</span>
<span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">Employee</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
<span class="k">GO</span>

<span class="c1">--Varchar(max): Not work</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">Employee</span>
<span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">identity</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">   </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="k">Max</span><span class="p">))</span>
<span class="k">GO</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">IX_EmployeeName</span>
<span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">Employee</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
<span class="k">GO</span>
</pre></div>
</div>
</section>
<section id="Primary-key-vs.-Unique-key">
<h2><span class="section-number">5.22. </span>Primary key vs. Unique key<a class="headerlink" href="#Primary-key-vs.-Unique-key" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tiêu chí</p></th>
<th class="head"><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Primary key
</pre></div>
</div>
</th>
<th class="head"><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Unique key
</pre></div>
</div>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NULL</p></td>
<td><p>Không cho phép null</p></td>
<td><p>Cho phép MỘT giá trị NULL</p></td>
</tr>
<tr class="row-odd"><td><p>Index</p></td>
<td><p>Default là clustered index</p></td>
<td><p>Default là unique non-cluster index</p></td>
</tr>
<tr class="row-even"><td><p>Limit</p></td>
<td><p>Chỉ có 1 key</p></td>
<td><p>Có thể có nhiều key</p></td>
</tr>
</tbody>
</table>
</section>
<section id="EXEC-vs.-EXEC()">
<h2><span class="section-number">5.23. </span>EXEC vs. EXEC()<a class="headerlink" href="#EXEC-vs.-EXEC()" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Exec dùng để thực hiện các procedure. VD: <code class="docutils literal notranslate"><span class="pre">exec</span> <span class="pre">sp_pivot</span></code></p></li>
<li><p>Exec() dùng để thực hiện dinamic SQL.</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">exec</span><span class="p">(</span><span class="s1">&#39;Select top 10 * from @table&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="Xem-tất-cả-các-user-defined-procedure">
<h2><span class="section-number">5.24. </span>Xem tất cả các user-defined procedure<a class="headerlink" href="#Xem-tất-cả-các-user-defined-procedure" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>
<span class="w">       </span><span class="k">type</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">sysobjects</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;P&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">and</span>
<span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;u%&#39;</span>
</pre></div>
</div>
</section>
<section id="Làm-việc-với-link-server">
<h2><span class="section-number">5.25. </span>Làm việc với link server<a class="headerlink" href="#Làm-việc-với-link-server" title="Link to this heading"></a></h2>
<p><strong>Vấn đề</strong>: Cách link server thủ công (GUI) có thể sẽ gặp vấn đề khi cùng lúc làm việc với nhiều server. Ta có thể sử dụng T-SQL để làm việc với link server như sau</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Bước 1: Tạo link server</span>

<span class="k">EXEC</span><span class="w"> </span><span class="n">sp_addlinkedserver</span>
<span class="w">   </span><span class="o">@</span><span class="n">server</span><span class="o">=</span><span class="s1">&#39;RBD&#39;</span><span class="p">,</span>
<span class="w">   </span><span class="o">@</span><span class="n">srvproduct</span><span class="o">=</span><span class="n">N</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">   </span><span class="o">@</span><span class="n">provider</span><span class="o">=</span><span class="n">N</span><span class="s1">&#39;SQLNCLI&#39;</span><span class="p">,</span>
<span class="w">   </span><span class="o">@</span><span class="n">datasrc</span><span class="o">=</span><span class="s1">&#39;10.39.200.204&#39;</span>

<span class="c1">-- Bước 2: Tạo password</span>

<span class="k">EXEC</span><span class="w"> </span><span class="n">sp_addlinkedsrvlogin</span>
<span class="w">  </span><span class="o">@</span><span class="n">rmtsrvname</span><span class="w"> </span><span class="o">=</span><span class="s1">&#39;RBD&#39;</span>
<span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">useself</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FALSE&#39;</span>
<span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">rmtuser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;bic_user&#39;</span>
<span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">rmtpassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;bic_user&#39;</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Kiểm tra tất cả link server</span>
<span class="n">sp_helpserver</span>

<span class="c1">-- Xóa link server RBD</span>
<span class="n">sp_dropserver</span><span class="w"> </span><span class="s1">&#39;RBD&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;droplogins&#39;</span><span class="p">;</span>
</pre></div>
</div>
<section id="Procedure-tạo-nhiều-link-server">
<h3><span class="section-number">5.25.1. </span>Procedure tạo nhiều link server<a class="headerlink" href="#Procedure-tạo-nhiều-link-server" title="Link to this heading"></a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">drop</span><span class="w"> </span><span class="k">procedure</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">u_createlinkserver</span>
<span class="k">GO</span>
<span class="k">create</span><span class="w"> </span><span class="k">procedure</span><span class="w"> </span><span class="n">u_createlinkserver</span>
<span class="w">    </span><span class="o">@</span><span class="n">name</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">),</span>
<span class="w">    </span><span class="o">@</span><span class="k">source</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">),</span>
<span class="w">    </span><span class="o">@</span><span class="k">user</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">),</span>
<span class="w">    </span><span class="o">@</span><span class="n">password</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">as</span>

<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">EXEC</span><span class="w"> </span><span class="n">sp_addlinkedserver</span>
<span class="w">       </span><span class="o">@</span><span class="n">server</span><span class="o">=@</span><span class="n">name</span><span class="p">,</span>
<span class="w">       </span><span class="o">@</span><span class="n">srvproduct</span><span class="o">=</span><span class="n">N</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">       </span><span class="o">@</span><span class="n">provider</span><span class="o">=</span><span class="n">N</span><span class="s1">&#39;SQLNCLI&#39;</span><span class="p">,</span>
<span class="w">       </span><span class="o">@</span><span class="n">datasrc</span><span class="o">=@</span><span class="k">source</span><span class="p">;</span>

<span class="w">    </span><span class="k">EXEC</span><span class="w"> </span><span class="n">sp_addlinkedsrvlogin</span>
<span class="w">      </span><span class="o">@</span><span class="n">rmtsrvname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">name</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">useself</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FALSE&#39;</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">rmtuser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="k">user</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">rmtpassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">password</span>
<span class="k">END</span>
</pre></div>
</div>
<p><strong>Ví dụ</strong>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">exec</span><span class="w"> </span><span class="n">u_createlinkserver</span>
<span class="w">    </span><span class="o">@</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;RBD&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">@</span><span class="k">source</span><span class="o">=</span><span class="s1">&#39;10.39.200.204&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">@</span><span class="k">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;bic_user&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">@</span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;bic_user&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="Tìm-tất-cả-các-bảng,-cột-trong-Database">
<h2><span class="section-number">5.26. </span>Tìm tất cả các bảng, cột trong Database<a class="headerlink" href="#Tìm-tất-cả-các-bảng,-cột-trong-Database" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;SERVER_74&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">SERVER</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;BICDATA&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">DATA_BASE</span><span class="p">,</span>
<span class="w">        </span><span class="n">lst</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">Table_Name</span><span class="p">,</span>
<span class="w">        </span><span class="n">lsc</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">Column_Name</span><span class="p">,</span>
<span class="w">        </span><span class="n">lsc</span><span class="p">.</span><span class="n">max_length</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Max_Length</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">M74</span><span class="p">].[</span><span class="n">BICDATA</span><span class="p">].[</span><span class="n">sys</span><span class="p">].[</span><span class="n">tables</span><span class="p">]</span><span class="w"> </span><span class="n">lst</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="p">[</span><span class="n">M74</span><span class="p">].[</span><span class="n">BICDATA</span><span class="p">].[</span><span class="n">sys</span><span class="p">].[</span><span class="n">columns</span><span class="p">]</span><span class="w"> </span><span class="n">lsc</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="n">lst</span><span class="p">.</span><span class="n">OBJECT_ID</span><span class="o">=</span><span class="n">lsc</span><span class="p">.</span><span class="n">object_id</span>
<span class="k">union</span>
<span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;SERVER_16&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">SERVER</span><span class="p">,</span>
<span class="w">       </span><span class="s1">&#39;VPB_WHR2&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">DATA_BASE</span><span class="p">,</span>
<span class="w">       </span><span class="n">lst</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">Table_Name</span><span class="p">,</span>
<span class="w">       </span><span class="n">lsc</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">Column_Name</span><span class="p">,</span>
<span class="w">       </span><span class="n">lsc</span><span class="p">.</span><span class="n">max_length</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Max_Length</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">M16</span><span class="p">].[</span><span class="n">VPB_WHR2</span><span class="p">].[</span><span class="n">sys</span><span class="p">].[</span><span class="n">tables</span><span class="p">]</span><span class="w"> </span><span class="n">lst</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="p">[</span><span class="n">M16</span><span class="p">].[</span><span class="n">VPB_WHR2</span><span class="p">].[</span><span class="n">sys</span><span class="p">].[</span><span class="n">columns</span><span class="p">]</span><span class="w"> </span><span class="n">lsc</span>
<span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="n">lst</span><span class="p">.</span><span class="n">OBJECT_ID</span><span class="o">=</span><span class="n">lsc</span><span class="p">.</span><span class="n">object_id</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">DATA_BASE</span><span class="p">,</span><span class="w"> </span><span class="n">lst</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">lsc</span><span class="p">.</span><span class="n">name</span>
</pre></div>
</div>
</section>
<section id="Chạy-file-.BAT-từ-T-SQL">
<h2><span class="section-number">5.27. </span>Chạy file .BAT từ T-SQL<a class="headerlink" href="#Chạy-file-.BAT-từ-T-SQL" title="Link to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">sp_configure</span><span class="w"> </span><span class="s1">&#39;show advanced options&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1&#39;</span>
<span class="n">RECONFIGURE</span>
<span class="n">sp_configure</span><span class="w"> </span><span class="s1">&#39;xp_cmdshell&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1&#39;</span>
<span class="n">RECONFIGURE</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXEC</span><span class="w"> </span><span class="n">xp_cmdshell</span><span class="w"> </span><span class="s1">&#39;cmd /c &quot;F:\D\my_file.bat&quot;&#39;</span>
</pre></div>
</div>
<p><strong>Lưu ý</strong>: Cách sử dụng <code class="docutils literal notranslate"><span class="pre">xp_cmdshell</span></code> khắc phục được nhược điểm của <code class="docutils literal notranslate"><span class="pre">sqlcmd</span></code>, cho phép đặt job với file <code class="docutils literal notranslate"><span class="pre">bat</span></code></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="p01-04-sql-style.html" class="btn btn-neutral float-left" title="4. SQL style guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="p01-06-sqlcmd.html" class="btn btn-neutral float-right" title="6. SQLCMD" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Anh Hoang Duc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>